<project>

	<property name="nutch-version" value="nutch-1.0" />
	
	<target name="init">
		<mkdir dir="build" />
	</target>

	<target name="clean">
		<delete dir="build" />
	</target>


	<target name="unzip-nutch" depends="init">
		<unzip src="contrib/${nutch-version}.zip" dest="build" />
	</target>


	<target name="patch-nutch">
		<patch patchfile="patches/opensource/build.xml.patch" dir="build/${nutch-version}" strip="0" />
		<patch patchfile="patches/opensource/build-plugins.xml.patch" dir="build/${nutch-version}" strip="0" />
		<patch patchfile="patches/opensource/build-plugin.xml.patch" dir="build/${nutch-version}" strip="0" />
		<patch patchfile="patches/opensource/nutch-extensionpoint-plugin.xml.patch" dir="build/${nutch-version}" strip="0" />
		<patch patchfile="patches/opensource/nutch-default.xml.patch" dir="build/${nutch-version}" strip="0" />
		<patch patchfile="patches/opensource/nutch.patch" dir="build/${nutch-version}" strip="0" />
	</target>

	<target name="copy-administration-ui">
		<antcall target="copy-administration-ui-sources" />
		<antcall target="copy-administration-ui-libraries" />
	</target>
	
	<target name="copy-administration-ui-sources">
		<copy todir="build/${nutch-version}/src/java">
			<fileset dir="administration-ui/src/java" />
		</copy>
	</target>

	<target name="copy-administration-ui-libraries">
		<copy todir="build/${nutch-version}/lib/admin-ui-ext">
			<fileset dir="administration-ui/lib" />
		</copy>
	</target>
	
	<target name="copy-administration-plugins">
		<antcall target="copy-admin-instance" />
		<antcall target="copy-admin-welcome" />
		<antcall target="copy-admin-scheduling" />
	</target>

	<target name="copy-admin-instance">
		<copy todir="build/${nutch-version}/src/plugin/admin-instance">
			<fileset dir="administration-ui/src/plugin/admin-instance" />
		</copy>
	</target>
	<target name="copy-admin-welcome">
		<copy todir="build/${nutch-version}/src/plugin/admin-welcome">
			<fileset dir="administration-ui/src/plugin/admin-welcome" />
		</copy>
	</target>
	<target name="copy-admin-scheduling">
		<copy todir="build/${nutch-version}/src/plugin/admin-scheduling">
			<fileset dir="administration-ui/src/plugin/admin-scheduling" />
		</copy>
	</target>

	<target name="dist" depends="unzip-nutch, patch-nutch, copy-administration-ui, copy-administration-plugins">
		<!--<ant antfile="build/${nutch-version}/build.xml" target="tar" />-->
	</target>
	
</project>